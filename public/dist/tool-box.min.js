$.fn.extend({center:function(a,b){return b=_.isPositive(b)?+b:0,a=_.isPositive(a)?+a:0,this.css({left:Math.max((document.documentElement.clientWidth-this.outerWidth())/2,b),top:Math.max((document.documentElement.clientHeight-this.outerHeight())/2,a)+$(window).scrollTop()})},swapWith:function(a){var b=$(a),c=this.clone(!0),d=b.clone(!0);return b.replaceWith(c),this.replaceWith(d),c},coverPoint:function(a,b){var c=this.offset();return a>=c.left&&b>=c.top&&a<=c.left+this.outerWidth()&&b<=c.top+this.outerHeight()},isChildOf:function(a){var b=this[0].parentNode;a=$(a)[0];do{if(b===a)return!0;b=b.parentNode}while(b);return!1}}),_.mixin({defaultsArray:function(a,b){return _.each(a,function(c,d){a[d]=_.defaults(c,b)})},makeArray:function(a){return _.isArray(a)?a:[a]},moveIndex:function(a,b,c){var d,e;+c&&-1!==(d=_.indexOf(a,b))&&(e=Math.min(Math.max(+c+d,0),a.length-1),a.splice(d,1),a.splice(e,0,b))},dayStart:function(a){var b=new Date(a);return _.isValidDate(b)?new Date(b.getFullYear(),b.getMonth(),b.getDate()).valueOf():_.dayStart(new Date)},dayEnd:function(a){var b=new Date(a);return _.isValidDate(b)?new Date(b.getFullYear(),b.getMonth(),b.getDate()+1).valueOf()-1:_.dayEnd(new Date)},formatTime:function(a,b){var c,d=new Date(a);return _.isValidDate(d)?(b=_.isString(b)?b:"YYYY-MM-DD",c={YYYY:d.getFullYear(),YY:(""+d.getFullYear()).slice(-2),MM:_.pad(d.getMonth()+1),M:d.getMonth()+1,DD:_.pad(d.getDate()),D:d.getDate(),HH:_.pad(d.getHours()),H:d.getHours(),mm:_.pad(d.getMinutes()),m:d.getMinutes(),ss:_.pad(d.getSeconds()),s:d.getSeconds()},b.replace(/(YYYY)|(\bYY\b)|(MM)|(\bM\b)|(DD)|(\bD\b)|(HH)|(\bH\b)|(mm)|(\bm\b)|(ss)|(\bs\b)/g,function(a){return c[a]})):_.formatTime(new Date,b)},exists:function(a){return!_.isNull(a)&&!_.isUndefined(a)},isNegative:function(a){return 0>a},isPositive:function(a){return a>0},isPureObject:function(a){return a&&"[object Object]"===Object.prototype.toString.call(a)},isValidDate:function(a){return _.isDate(a)&&_.isFinite(a.valueOf())},notEmpty:function(a){return _.exists(a)&&""!==a},safeExtendOwn:function(a){var b,c,d,e,f,g,h=arguments.length;if(2>h||!_.exists(a))return a;for(b=1;h>b;b+=1)for(c=arguments[b],d=_.keys(c),e=d.length,f=0;e>f;f+=1)g=d[f],_.isUndefined(a[g])?a[g]=c[g]:_.error(['Key "',g,'" already exists.'].join(""));return a},snapshot:function(a){return _.exists(a)&&"object"==typeof a?_.reduce(_.keys(a),function(b,c){return b[c]=_.snapshot(a[c]),b},new a.constructor):a},capitalize:function(a){return a=_.exists(a)?""+a:"",a.charAt(0).toUpperCase()+a.substring(1).toLowerCase()},error:function(){window.console&&window.console.log.apply?window.console.info.apply(console,arguments):window.console&&window.console.info(arguments[0])},"int":function(a){return parseInt(a,10)},formatNumber:function(a,b){var c="-"===(a+"").slice(0,1)?"-":"";return _.isNaN(+a)?"":(b&&(a=(+a).toFixed(b)),a=(a+"").replace("-","").split("."),result=_.reduceRight(a[0],function(b,c,d){return((a[0].length-d)%3||!d?"":",")+c+b},""),_.isUndefined(a[1])||(result+=".",result+=_.reduce(a[1],function(b,c,d){return b+c+(d%3===2&&d!==a[1].length-1?",":"")},"")),c+result)},log:function(){window.console&&window.console.log.apply?window.console.log.apply(console,arguments):window.console&&window.console.log(arguments[0])},num:function(a){return _.isFinite(a)?+a:a},pad:function(a,b,c,d){var e;return a=_.exists(a)?""+a:"",b=_.isFinite(b)?Math.abs(Math.floor(b)):2,c=_.exists(c)&&(""+c).length>0?(""+c).charAt(0):"0",d=!!d,(e=b-a.length)<=0?a:d?a+new Array(e+1).join(c):new Array(e+1).join(c)+a},parseNumber:function(a){return+a.replace(/,/g,"")},parseQuery:function(a){var b=_.isString(a)?a.slice(1):"";return b.length?_.reduce(b.split("&"),function(a,b){return a[b.split("=")[0]]=b.split("=")[1],a},{}):{}}}),function(a){var b={},c="";a.addLang=function(c){a.each(c,function(c,d){b[d]||(b[d]={}),a.safeExtendOwn(b[d],c)})},a.parseLocale=function(a){return b[c]?b[c][a]||"":""},a.setLang=function(a){c=a}}(_),function(a,b){var c,d,e,f=["get","set"],g=["initialize","render","remove"],h=a.extend;c=function(a){var b,c=h.apply(this,arguments);for(b in a)a.hasOwnProperty(b)&&_.isPureObject(a[b])&&_.isPureObject(this.prototype[b])&&(c.prototype[b]=_.extend({},this.prototype[b],a[b]));return c},d=function(a,b){this.constructor.__super__[a].apply(this,b)},e=Backbone.ItemView=function(){b.apply(this,arguments),this.modelShortcut(f),this.listenToModelEvents(_.result(this,"modelEvents")),this.listenToViewEvents(g),this.listenToViewEvents(_.result(this,"viewEvents")),this.model&&(this.model.view=this),this.trigger("initialize")},_.extend(e.prototype,b.prototype,{template:"",render:function(){return this._initTemplate(),this.$el.html(this.template(this.model?this.model.toJSON():null)),this._makeUiShortcuts(),this.trigger("render"),this},remove:function(){return this.trigger("remove"),b.prototype.remove.apply(this,arguments)},linkView:function(a,b){return b||(b={}),this[b.anotherName||"child"]=a,a[b.thisName||"parent"]=this,b.holder&&a.$el.appendTo(this.$(b.holder)),this.listenToModelEvents(b.modelEventsListening,a.model),this.listenToViewEvents(b.viewEventsListening,a),a.listenToModelEvents(b.modelEventsListened,this.model),a.listenToViewEvents(b.viewEventsListened,this),this},listenToModelEvents:function(a,b){var c,d;if(b||(b=this.model),!b||!a)return this;for(c in a)a.hasOwnProperty(c)&&(d=a[c],_.isFunction(d)||(d=this[a[c]]),d&&this.listenTo(b,c,d));return this},listenToViewEvents:function(a,b){var c,d,e;if(!a)return this;if(_.isArray(a))_.each(a,function(a){d="on"+_.capitalize(a),_.isFunction(c=this[d])&&this.on(a,c)},this);else for(e in a)if(a.hasOwnProperty(e)){if(c=a[e],_.isFunction(c)||(c=this[a[e]]),!c)return;b?this.listenTo(b,e,c):this.on(e,c)}return this},modelShortcut:function(a){return _.each(a,function(a){this[a]=function(){return this.model?this.model[a].apply(this.model,arguments):void 0}},this),this},_initTemplate:function(){_.isFunction(this.template)||(this.template=_.template(this.template))},_makeUiShortcuts:function(){var a,b;if(this.ui)for(a in this.ui)this.ui.hasOwnProperty(a)&&(b=this.$(this.ui[a]),b.length?this.ui[a]=b:delete this.ui[a])}}),e.prototype._super=b.prototype._super=a.prototype._super=d,e.extend=b.extend=a.extend=c}(Backbone.Model,Backbone.View);